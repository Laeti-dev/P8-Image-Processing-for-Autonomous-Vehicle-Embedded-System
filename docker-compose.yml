# Run Streamlit + FastAPI with env vars from .env
# Usage: docker compose up --build
# Streamlit: http://localhost:8501  |  API: http://localhost:8001
# (API on 8001 to avoid conflict with other apps using 8000)

services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        APP_MODE: both
    env_file: .env
    ports:
      - "8501:8501"
      - "8001:8000"
    volumes:
      # Persist model cache so Azure download is reused between runs
      - models-cache:/app/models

volumes:
  models-cache:
